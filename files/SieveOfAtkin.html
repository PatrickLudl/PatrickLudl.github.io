<h1 id="sieve-of-atkin">Sieve of Atkin</h1>
<p>The Sieve of Atkin and Bernstein is a modern algorithm to compute the
prime numbers smaller than N. In the description below, we follow the
Wikipedia Article <a
href="https://en.wikipedia.org/wiki/Sieve_of_Atkin">SieveOfAtkin</a>. We
describe the program flow both as text, and graphically.</p>
<h2 id="program">Program</h2>
<h3 id="function-fliplist-sievelist-int-n">Function Flip(list<bool>
SieveList, int n)</h3>
<ul>
<li>If n &lt;= length(SieveList): Flip the entry: n-th entry of
SieveList = not(n-th entry of SieveList).</li>
</ul>
<h3 id="main-program">Main Program</h3>
<ul>
<li>Get integer number N &gt; 6 as input.</li>
<li>Initialize ListOfPrimes = [2, 3, 5].</li>
<li>Create a list SieveList of N bools, all entries false.</li>
<li>For x in
{1,…,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><mi>N</mi></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{floor}(\sqrt{N})</annotation></semantics></math>}
<ul>
<li>For y in
{1,…,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi></mrow><mo stretchy="false" form="prefix">(</mo><msqrt><mrow><mi>N</mi><mo stretchy="false" form="postfix">)</mo></mrow></msqrt></mrow><annotation encoding="application/x-tex">\mathrm{floor}(\sqrt{N)}</annotation></semantics></math>}
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n = 4 x^2 + y^2</annotation></semantics></math>
<ul>
<li>If n mod 60 in {1, 13, 17, 29, 37, 41, 49, 53}: Flip(SieveList,
n).</li>
</ul></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>3</mn><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n = 3 x^2 + y^2</annotation></semantics></math>
<ul>
<li>If n mod 60 in {7, 19, 31, 43}: Flip(SieveList, n).</li>
</ul></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>3</mn><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><msup><mi>y</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n = 3 x^2 - y^2</annotation></semantics></math>
<ul>
<li>If x &gt; y and n mod 60 in {11, 23, 47, or 59}: Flip(SieveList,
n).</li>
</ul></li>
</ul></li>
</ul></li>
<li>While there are entries true in the SieveList:
<ul>
<li>Determine k such that: The k-th entry of SieveList is the first with
entry true:
<ul>
<li>Append k to ListOfPrimes.</li>
<li>Set k-th entry of SieveList to false (we do not want to check it
again).</li>
<li>Set m<em>k^2-th entry of SieveList to false for all multiples
m</em>k^2 of k^2 (m = 1,2,…,floor(N/k^2)).</li>
</ul></li>
</ul></li>
<li>Return ListOfPrimes.</li>
</ul>
<h3 id="main-program-as-mermaid.js-graph">Main Program as graph</h3>
<img src="SieveOfAtkin.svg" alt="The Sieve of Atkin">
